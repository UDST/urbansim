

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Statistical Models &mdash; urbansim 3.1.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="urbansim 3.1.1 documentation" href="../index.html"/>
        <link rel="up" title="Core Models" href="index.html"/>
        <link rel="next" title="Supply and Demand Accounting" href="supplydemand.html"/>
        <link rel="prev" title="Core Models" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> urbansim
          

          
          </a>

          
            
            
              <div class="version">
                3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Core Models</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#introduction">Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#contents">Contents</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Statistical Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-expressions">Model Expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yaml-persistence">YAML Persistence</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="supplydemand.html">Supply and Demand Accounting</a></li>
<li class="toctree-l3"><a class="reference internal" href="transrelo.html">Transition and Relocation Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="util.html">Model Related Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="urbanchoice.html">Location Choice Utilities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Real Estate Development Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">UrbanSim Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maps/index.html">DataFrame Explorer</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">urbansim</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Core Models</a> &raquo;</li>
        
      <li>Statistical Models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/models/statistical.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="statistical-models">
<span id="id1"></span><h1>Statistical Models<a class="headerlink" href="#statistical-models" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>UrbanSim has two sets of statistical models: regressions and
discrete choice models.
Each has a three stage usage pattern:</p>
<ol class="arabic simple">
<li>Create a configured model instance. This is where you will supply
most of the information to the model such as the actual definition
of the model and any filters that restrict the data used during
fitting and prediction.</li>
<li>Fit the model by supplying base year data.</li>
<li>Make predictions based on new data.</li>
</ol>
</div>
<div class="section" id="model-expressions">
<h2>Model Expressions<a class="headerlink" href="#model-expressions" title="Permalink to this headline">¶</a></h2>
<p>Statistical models require specification of a &#8220;model expression&#8221; that
describes the model as a mathematical formula.
UrbanSim uses <a class="reference external" href="http://patsy.readthedocs.org/">patsy</a> to interpret
model expressions, but UrbanSim gives you some flexibility
as to how you define them.</p>
<p><a class="reference external" href="http://patsy.readthedocs.org/">patsy</a> works with string formula like this simplified regression example
(names refer to columns in the <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/dsintro.html#dataframe">DataFrames</a> used during fitting and prediction):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="s1">&#39;np.log1p(sqft_price) ~ I(year_built &lt; 1940) + dist_hwy + ave_income&#39;</span>
</pre></div>
</div>
<p>In UrbanSim that same formula could be expressed in a dictionary:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;left_side&#39;</span><span class="p">:</span> <span class="s1">&#39;np.log1p(sqft_price)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;right_side&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;I(year_built &lt; 1940)&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_hwy&#39;</span><span class="p">,</span> <span class="s1">&#39;ave_income&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Formulae used with location choice models have only a right hand side
since the models do not predict new numeric values. Right-hand-side formulae
can be written as lists or dictionaries:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;right_side&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;I(year_built &lt; 1940)&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_hwy&#39;</span><span class="p">,</span> <span class="s1">&#39;ave_income&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">expr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;I(year_built &lt; 1940)&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_hwy&#39;</span><span class="p">,</span> <span class="s1">&#39;ave_income&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Expressing the formula as a string is always an option.
The ability to use lists or dictionaries are especially useful to make
attractively formatted formulae in <a class="reference internal" href="#yaml-config"><span class="std std-ref">YAML config files</span></a>.</p>
</div>
<div class="section" id="yaml-persistence">
<span id="yaml-config"></span><h2>YAML Persistence<a class="headerlink" href="#yaml-persistence" title="Permalink to this headline">¶</a></h2>
<p>UrbanSim&#8217;s regression and location choice models can be saved as
<a class="reference external" href="http://en.wikipedia.org/wiki/YAML">YAML</a> files and loaded again
at another time.
This feature is especially useful for estimating models in one location,
saving the fit parameters to disk, and then using the fitted model for
prediction somewhere else.</p>
<p>Use the <code class="docutils literal"><span class="pre">.to_yaml</span></code> and <code class="docutils literal"><span class="pre">.from_yaml</span></code> methods to save files to disk
and load them back as configured models.
Here&#8217;s an example of loading a regression model, performing fitting, and
saving the model back to YAML:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RegressionModel</span><span class="o">.</span><span class="n">from_yaml</span><span class="p">(</span><span class="s1">&#39;my_model.yaml&#39;</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">(</span><span class="s1">&#39;my_model.yaml&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can, if you like, write your model configurations entirely in
YAML and load them into Python only for fitting and prediction.</p>
</div>
<div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="regression-api">
<h3>Regression API<a class="headerlink" href="#regression-api" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#urbansim.models.regression.RegressionModel" title="urbansim.models.regression.RegressionModel"><code class="xref py py-obj docutils literal"><span class="pre">RegressionModel</span></code></a>(fit_filters,&nbsp;...[,&nbsp;...])</td>
<td>A hedonic (regression) model with the ability to store an estimated model and predict new data based on the model.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#urbansim.models.regression.SegmentedRegressionModel" title="urbansim.models.regression.SegmentedRegressionModel"><code class="xref py py-obj docutils literal"><span class="pre">SegmentedRegressionModel</span></code></a>(segmentation_col[,&nbsp;...])</td>
<td>A regression model group that allows segments to have different model expressions and ytransforms but all have the same filters.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#urbansim.models.regression.RegressionModelGroup" title="urbansim.models.regression.RegressionModelGroup"><code class="xref py py-obj docutils literal"><span class="pre">RegressionModelGroup</span></code></a>(segmentation_col[,&nbsp;name])</td>
<td>Manages a group of regression models that refer to different segments within a single table.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="discrete-choice-api">
<h3>Discrete Choice API<a class="headerlink" href="#discrete-choice-api" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#urbansim.models.dcm.MNLDiscreteChoiceModel" title="urbansim.models.dcm.MNLDiscreteChoiceModel"><code class="xref py py-obj docutils literal"><span class="pre">MNLDiscreteChoiceModel</span></code></a>(model_expression,&nbsp;...)</td>
<td>A discrete choice model with the ability to store an estimated model and predict new data based on the model.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel" title="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel"><code class="xref py py-obj docutils literal"><span class="pre">SegmentedMNLDiscreteChoiceModel</span></code></a>(...[,&nbsp;...])</td>
<td>An MNL LCM group that allows segments to have different model expressions but otherwise share configurations.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup" title="urbansim.models.dcm.MNLDiscreteChoiceModelGroup"><code class="xref py py-obj docutils literal"><span class="pre">MNLDiscreteChoiceModelGroup</span></code></a>(segmentation_col)</td>
<td>Manages a group of discrete choice models that refer to different segments of choosers.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-urbansim.models.regression">
<span id="regression-api-docs"></span><h3>Regression API Docs<a class="headerlink" href="#module-urbansim.models.regression" title="Permalink to this headline">¶</a></h3>
<p>Use the <code class="docutils literal"><span class="pre">RegressionModel</span></code> class to fit a model using statsmodels&#8217;
OLS capability and then do subsequent prediction.</p>
<dl class="class">
<dt id="urbansim.models.regression.RegressionModel">
<em class="property">class </em><code class="descclassname">urbansim.models.regression.</code><code class="descname">RegressionModel</code><span class="sig-paren">(</span><em>fit_filters</em>, <em>predict_filters</em>, <em>model_expression</em>, <em>ytransform=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A hedonic (regression) model with the ability to store an
estimated model and predict new data based on the model.</p>
<p>statsmodels&#8217; OLS implementation is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fit_filters</strong> : list of str</p>
<blockquote>
<div><p>Filters applied before fitting the model.</p>
</div></blockquote>
<p><strong>predict_filters</strong> : list of str</p>
<blockquote>
<div><p>Filters applied before calculating new data points.</p>
</div></blockquote>
<p><strong>model_expression</strong> : str or dict</p>
<blockquote>
<div><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.</p>
</div></blockquote>
<p><strong>ytransform</strong> : callable, optional</p>
<blockquote>
<div><p>A function to call on the array of predicted output.
For example, if the model relation is predicting the log
of price, you might pass <code class="docutils literal"><span class="pre">ytransform=np.exp</span></code> so that
the results reflect actual price.</p>
<p>By default no transformation is applied.</p>
</div></blockquote>
<p><strong>name</strong> : optional</p>
<blockquote class="last">
<div><p>Optional descriptive name for this model that may be used
in output.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="urbansim.models.regression.RegressionModel.assert_fitted">
<code class="descname">assert_fitted</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.assert_fitted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.assert_fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises a RuntimeError if the model is not ready for prediction.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.RegressionModel.columns_used">
<code class="descname">columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the columns used in this model for filtering
and in the model expression.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.RegressionModel.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>data</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model to data and store/return the results.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Data to use for fitting the model. Must contain all the
columns referenced by the <cite>model_expression</cite>.</p>
</div></blockquote>
<p><strong>debug</strong> : bool</p>
<blockquote>
<div><p>If debug is set to true, this sets the attribute &#8220;est_data&#8221;
to a dataframe with the actual data used for estimation of
this model.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fit</strong> : statsmodels.regression.linear_model.OLSResults</p>
<blockquote class="last">
<div><p>This is returned for inspection, but also stored on the
class instance for use during prediction.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.regression.RegressionModel.fit_from_cfg">
<em class="property">classmethod </em><code class="descname">fit_from_cfg</code><span class="sig-paren">(</span><em>df</em>, <em>cfgname</em>, <em>debug=False</em>, <em>outcfgname=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.fit_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.fit_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>df</strong> : DataFrame</p>
<blockquote>
<div><p>The dataframe which contains the columns to use for the estimation.</p>
</div></blockquote>
<p><strong>cfgname</strong> : string</p>
<blockquote>
<div><p>The name of the yaml config file which describes the hedonic model.</p>
</div></blockquote>
<p><strong>debug</strong> : boolean, optional (default False)</p>
<blockquote>
<div><p>Whether to generate debug information on the model.</p>
</div></blockquote>
<p><strong>outcfgname</strong> : string, optional (default cfgname)</p>
<blockquote>
<div><p>The name of the output yaml config file where estimation results are written into.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">RegressionModel which was used to fit</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="urbansim.models.regression.RegressionModel.fitted">
<code class="descname">fitted</code><a class="headerlink" href="#urbansim.models.regression.RegressionModel.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the model is ready for prediction.</p>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.regression.RegressionModel.from_yaml">
<em class="property">classmethod </em><code class="descname">from_yaml</code><span class="sig-paren">(</span><em>yaml_str=None</em>, <em>str_or_buffer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.from_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a RegressionModel instance from a saved YAML configuration.
Arguments are mutually exclusive.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>yaml_str</strong> : str, optional</p>
<blockquote>
<div><p>A YAML string from which to load model.</p>
</div></blockquote>
<p><strong>str_or_buffer</strong> : str or file like, optional</p>
<blockquote>
<div><p>File name or buffer from which to load YAML.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">RegressionModel</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.RegressionModel.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict a new data set based on an estimated model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Data to use for prediction. Must contain all the columns
referenced by the right-hand side of the <cite>model_expression</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Predicted values as a pandas Series. Will have the index of <cite>data</cite>
after applying filters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.regression.RegressionModel.predict_from_cfg">
<em class="property">classmethod </em><code class="descname">predict_from_cfg</code><span class="sig-paren">(</span><em>df</em>, <em>cfgname</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.predict_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.predict_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>df</strong> : DataFrame</p>
<blockquote>
<div><p>The dataframe which contains the columns to use for the estimation.</p>
</div></blockquote>
<p><strong>cfgname</strong> : string</p>
<blockquote>
<div><p>The name of the yaml config file which describes the hedonic model.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>predicted</strong> : pandas.Series</p>
<blockquote>
<div><p>Predicted data in a pandas Series. Will have the index of <cite>data</cite>
after applying filters and minus any groups that do not have
models.</p>
</div></blockquote>
<p class="last"><strong>hm</strong> : RegressionModel which was used to predict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.RegressionModel.report_fit">
<code class="descname">report_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.report_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.report_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a report of the fit results.</p>
</dd></dl>

<dl class="attribute">
<dt id="urbansim.models.regression.RegressionModel.str_model_expression">
<code class="descname">str_model_expression</code><a class="headerlink" href="#urbansim.models.regression.RegressionModel.str_model_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Model expression as a string suitable for use with patsy/statsmodels.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.RegressionModel.to_dict">
<code class="descname">to_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.to_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary representation of a RegressionModel instance.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.RegressionModel.to_yaml">
<code class="descname">to_yaml</code><span class="sig-paren">(</span><em>str_or_buffer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModel.to_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModel.to_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a model respresentation to YAML.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>str_or_buffer</strong> : str or file like, optional</p>
<blockquote>
<div><p>By default a YAML string is returned. If a string is
given here the YAML will be written to that file.
If an object with a <code class="docutils literal"><span class="pre">.write</span></code> method is given the
YAML will be written to that object.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>j</strong> : str</p>
<blockquote class="last">
<div><p>YAML string if <cite>str_or_buffer</cite> is not given.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="urbansim.models.regression.RegressionModelGroup">
<em class="property">class </em><code class="descclassname">urbansim.models.regression.</code><code class="descname">RegressionModelGroup</code><span class="sig-paren">(</span><em>segmentation_col</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Manages a group of regression models that refer to different segments
within a single table.</p>
<p>Model names must match the segment names after doing a Pandas groupby.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>segmentation_col</strong></p>
<blockquote>
<div><p>Name of the column on which to segment.</p>
</div></blockquote>
<p><strong>name</strong></p>
<blockquote class="last">
<div><p>Optional name used to identify the model in places.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="urbansim.models.regression.RegressionModelGroup.add_model">
<code class="descname">add_model</code><span class="sig-paren">(</span><em>model</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup.add_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.add_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a <cite>RegressionModel</cite> instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>model</strong> : <cite>RegressionModel</cite></p>
<blockquote class="last">
<div><p>Should have a <code class="docutils literal"><span class="pre">.name</span></code> attribute matching one of
the groupby segments.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.RegressionModelGroup.add_model_from_params">
<code class="descname">add_model_from_params</code><span class="sig-paren">(</span><em>name</em>, <em>fit_filters</em>, <em>predict_filters</em>, <em>model_expression</em>, <em>ytransform=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup.add_model_from_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.add_model_from_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a model by passing arguments through to <cite>RegressionModel</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : any</p>
<blockquote>
<div><p>Must match a groupby segment name.</p>
</div></blockquote>
<p><strong>fit_filters</strong> : list of str</p>
<blockquote>
<div><p>Filters applied before fitting the model.</p>
</div></blockquote>
<p><strong>predict_filters</strong> : list of str</p>
<blockquote>
<div><p>Filters applied before calculating new data points.</p>
</div></blockquote>
<p><strong>model_expression</strong> : str</p>
<blockquote>
<div><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.</p>
</div></blockquote>
<p><strong>ytransform</strong> : callable, optional</p>
<blockquote class="last">
<div><p>A function to call on the array of predicted output.
For example, if the model relation is predicting the log
of price, you might pass <code class="docutils literal"><span class="pre">ytransform=np.exp</span></code> so that
the results reflect actual price.</p>
<p>By default no transformation is applied.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.RegressionModelGroup.columns_used">
<code class="descname">columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the columns used across all models in the group
for filtering and in the model expression.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.RegressionModelGroup.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>data</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit each of the models in the group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Must have a column with the same name as <cite>segmentation_col</cite>.</p>
</div></blockquote>
<p><strong>debug</strong> : bool</p>
<blockquote>
<div><p>If set to true (default false) will pass the debug parameter
to model estimation.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fits</strong> : dict of statsmodels.regression.linear_model.OLSResults</p>
<blockquote class="last">
<div><p>Keys are the segment names.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="urbansim.models.regression.RegressionModelGroup.fitted">
<code class="descname">fitted</code><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether all models in the group have been fitted.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.RegressionModelGroup.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#RegressionModelGroup.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.RegressionModelGroup.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict new data for each group in the segmentation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Data to use for prediction. Must have a column with the
same name as <cite>segmentation_col</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>predicted</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Predicted data in a pandas Series. Will have the index of <cite>data</cite>
after applying filters and minus any groups that do not have
models.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="urbansim.models.regression.SegmentedRegressionModel">
<em class="property">class </em><code class="descclassname">urbansim.models.regression.</code><code class="descname">SegmentedRegressionModel</code><span class="sig-paren">(</span><em>segmentation_col</em>, <em>fit_filters=None</em>, <em>predict_filters=None</em>, <em>default_model_expr=None</em>, <em>default_ytransform=None</em>, <em>min_segment_size=0</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A regression model group that allows segments to have different
model expressions and ytransforms but all have the same filters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>segmentation_col</strong></p>
<blockquote>
<div><p>Name of column in the data table on which to segment. Will be used
with a pandas groupby on the data table.</p>
</div></blockquote>
<p><strong>fit_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied before fitting the model.</p>
</div></blockquote>
<p><strong>predict_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied before calculating new data points.</p>
</div></blockquote>
<p><strong>min_segment_size</strong> : int</p>
<blockquote>
<div><p>This model will add all segments that have at least this number of
observations. A very small number of observations (e.g. 1) will
cause an error with estimation.</p>
</div></blockquote>
<p><strong>default_model_expr</strong> : str or dict, optional</p>
<blockquote>
<div><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.</p>
</div></blockquote>
<p><strong>default_ytransform</strong> : callable, optional</p>
<blockquote>
<div><p>A function to call on the array of predicted output.
For example, if the model relation is predicting the log
of price, you might pass <code class="docutils literal"><span class="pre">ytransform=np.exp</span></code> so that
the results reflect actual price.</p>
<p>By default no transformation is applied.</p>
</div></blockquote>
<p><strong>min_segment_size</strong> : int, optional</p>
<blockquote>
<div><p>Segments with less than this many members will be skipped.</p>
</div></blockquote>
<p><strong>name</strong> : str, optional</p>
<blockquote class="last">
<div><p>A name used in places to identify the model.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.add_segment">
<code class="descname">add_segment</code><span class="sig-paren">(</span><em>name</em>, <em>model_expression=None</em>, <em>ytransform='default'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.add_segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.add_segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new segment with its own model expression and ytransform.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name :</strong></p>
<blockquote>
<div><p>Segment name. Must match a segment in the groupby of the data.</p>
</div></blockquote>
<p><strong>model_expression</strong> : str or dict, optional</p>
<blockquote>
<div><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.
If not given the default model will be used, which must not be
None.</p>
</div></blockquote>
<p><strong>ytransform</strong> : callable, optional</p>
<blockquote class="last">
<div><p>A function to call on the array of predicted output.
For example, if the model relation is predicting the log
of price, you might pass <code class="docutils literal"><span class="pre">ytransform=np.exp</span></code> so that
the results reflect actual price.</p>
<p>If not given the default ytransform will be used.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.columns_used">
<code class="descname">columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the columns used across all models in the group
for filtering and in the model expression.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>data</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit each segment. Segments that have not already been explicitly
added will be automatically added with default model and ytransform.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Must have a column with the same name as <cite>segmentation_col</cite>.</p>
</div></blockquote>
<p><strong>debug</strong> : bool</p>
<blockquote>
<div><p>If set to true will pass debug to the fit method of each model.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fits</strong> : dict of statsmodels.regression.linear_model.OLSResults</p>
<blockquote class="last">
<div><p>Keys are the segment names.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.regression.SegmentedRegressionModel.fit_from_cfg">
<em class="property">classmethod </em><code class="descname">fit_from_cfg</code><span class="sig-paren">(</span><em>df</em>, <em>cfgname</em>, <em>debug=False</em>, <em>min_segment_size=None</em>, <em>outcfgname=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.fit_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.fit_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>df</strong> : DataFrame</p>
<blockquote>
<div><p>The dataframe which contains the columns to use for the estimation.</p>
</div></blockquote>
<p><strong>cfgname</strong> : string</p>
<blockquote>
<div><p>The name of the yaml config file which describes the hedonic model.</p>
</div></blockquote>
<p><strong>debug</strong> : boolean, optional (default False)</p>
<blockquote>
<div><p>Whether to generate debug information on the model.</p>
</div></blockquote>
<p><strong>min_segment_size</strong> : int, optional</p>
<blockquote>
<div><p>Set attribute on the model.</p>
</div></blockquote>
<p><strong>outcfgname</strong> : string, optional (default cfgname)</p>
<blockquote>
<div><p>The name of the output yaml config file where estimation results are written into.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>hm</strong> : SegmentedRegressionModel which was used to fit</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="urbansim.models.regression.SegmentedRegressionModel.fitted">
<code class="descname">fitted</code><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether models for all segments have been fit.</p>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.regression.SegmentedRegressionModel.from_yaml">
<em class="property">classmethod </em><code class="descname">from_yaml</code><span class="sig-paren">(</span><em>yaml_str=None</em>, <em>str_or_buffer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.from_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a SegmentedRegressionModel instance from a saved YAML
configuration. Arguments are mutally exclusive.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>yaml_str</strong> : str, optional</p>
<blockquote>
<div><p>A YAML string from which to load model.</p>
</div></blockquote>
<p><strong>str_or_buffer</strong> : str or file like, optional</p>
<blockquote>
<div><p>File name or buffer from which to load YAML.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">SegmentedRegressionModel</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict new data for each group in the segmentation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Data to use for prediction. Must have a column with the
same name as <cite>segmentation_col</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>predicted</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Predicted data in a pandas Series. Will have the index of <cite>data</cite>
after applying filters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.regression.SegmentedRegressionModel.predict_from_cfg">
<em class="property">classmethod </em><code class="descname">predict_from_cfg</code><span class="sig-paren">(</span><em>df</em>, <em>cfgname</em>, <em>min_segment_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.predict_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.predict_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>df</strong> : DataFrame</p>
<blockquote>
<div><p>The dataframe which contains the columns to use for the estimation.</p>
</div></blockquote>
<p><strong>cfgname</strong> : string</p>
<blockquote>
<div><p>The name of the yaml config file which describes the hedonic model.</p>
</div></blockquote>
<p><strong>min_segment_size</strong> : int, optional</p>
<blockquote>
<div><p>Set attribute on the model.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>predicted</strong> : pandas.Series</p>
<blockquote>
<div><p>Predicted data in a pandas Series. Will have the index of <cite>data</cite>
after applying filters and minus any groups that do not have
models.</p>
</div></blockquote>
<p class="last"><strong>hm</strong> : SegmentedRegressionModel which was used to predict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.to_dict">
<code class="descname">to_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.to_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict representation of this instance suitable for
conversion to YAML.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.regression.SegmentedRegressionModel.to_yaml">
<code class="descname">to_yaml</code><span class="sig-paren">(</span><em>str_or_buffer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#SegmentedRegressionModel.to_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.SegmentedRegressionModel.to_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a model respresentation to YAML.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>str_or_buffer</strong> : str or file like, optional</p>
<blockquote>
<div><p>By default a YAML string is returned. If a string is
given here the YAML will be written to that file.
If an object with a <code class="docutils literal"><span class="pre">.write</span></code> method is given the
YAML will be written to that object.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>j</strong> : str</p>
<blockquote class="last">
<div><p>YAML string if <cite>str_or_buffer</cite> is not given.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="urbansim.models.regression.fit_model">
<code class="descclassname">urbansim.models.regression.</code><code class="descname">fit_model</code><span class="sig-paren">(</span><em>df</em>, <em>filters</em>, <em>model_expression</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#fit_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.fit_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Use statsmodels OLS to construct a model relation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>df</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Data to use for fit. Should contain all the columns
referenced in the <cite>model_expression</cite>.</p>
</div></blockquote>
<p><strong>filters</strong> : list of str</p>
<blockquote>
<div><p>Any filters to apply before doing the model fit.</p>
</div></blockquote>
<p><strong>model_expression</strong> : str</p>
<blockquote>
<div><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>fit</strong> : statsmodels.regression.linear_model.OLSResults</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="urbansim.models.regression.predict">
<code class="descclassname">urbansim.models.regression.</code><code class="descname">predict</code><span class="sig-paren">(</span><em>df</em>, <em>filters</em>, <em>model_fit</em>, <em>ytransform=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/regression.html#predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.regression.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply model to new data to predict new dependent values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>df</strong> : pandas.DataFrame</p>
<p><strong>filters</strong> : list of str</p>
<blockquote>
<div><p>Any filters to apply before doing prediction.</p>
</div></blockquote>
<p><strong>model_fit</strong> : statsmodels.regression.linear_model.OLSResults</p>
<blockquote>
<div><p>Result of model estimation.</p>
</div></blockquote>
<p><strong>ytransform</strong> : callable, optional</p>
<blockquote>
<div><p>A function to call on the array of predicted output.
For example, if the model relation is predicting the log
of price, you might pass <code class="docutils literal"><span class="pre">ytransform=np.exp</span></code> so that
the results reflect actual price.</p>
<p>By default no transformation is applied.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Predicted values as a pandas Series. Will have the index of <cite>df</cite>
after applying filters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-urbansim.models.dcm">
<span id="discrete-choice-api-docs"></span><h3>Discrete Choice API Docs<a class="headerlink" href="#module-urbansim.models.dcm" title="Permalink to this headline">¶</a></h3>
<p>Use the <code class="docutils literal"><span class="pre">MNLDiscreteChoiceModel</span></code> class to train a choice module using
multinomial logit and make subsequent choice predictions.</p>
<dl class="class">
<dt id="urbansim.models.dcm.DiscreteChoiceModel">
<em class="property">class </em><code class="descclassname">urbansim.models.dcm.</code><code class="descname">DiscreteChoiceModel</code><a class="reference internal" href="../_modules/urbansim/models/dcm.html#DiscreteChoiceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.DiscreteChoiceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class for discrete choice models.</p>
</dd></dl>

<dl class="class">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel">
<em class="property">class </em><code class="descclassname">urbansim.models.dcm.</code><code class="descname">MNLDiscreteChoiceModel</code><span class="sig-paren">(</span><em>model_expression</em>, <em>sample_size</em>, <em>probability_mode='full_product'</em>, <em>choice_mode='individual'</em>, <em>choosers_fit_filters=None</em>, <em>choosers_predict_filters=None</em>, <em>alts_fit_filters=None</em>, <em>alts_predict_filters=None</em>, <em>interaction_predict_filters=None</em>, <em>estimation_sample_size=None</em>, <em>prediction_sample_size=None</em>, <em>choice_column=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A discrete choice model with the ability to store an estimated
model and predict new data based on the model.
Based on multinomial logit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>model_expression</strong> : str, iterable, or dict</p>
<blockquote>
<div><p>A patsy model expression. Should contain only a right-hand side.</p>
</div></blockquote>
<p><strong>sample_size</strong> : int</p>
<blockquote>
<div><p>Number of choices to sample for estimating the model.</p>
</div></blockquote>
<p><strong>probability_mode</strong> : str, optional</p>
<blockquote>
<div><p>Specify the method to use for calculating probabilities
during prediction.
Available string options are &#8216;single_chooser&#8217; and &#8216;full_product&#8217;.
In &#8220;single chooser&#8221; mode one agent is chosen for calculating
probabilities across all alternatives. In &#8220;full product&#8221; mode
probabilities are calculated for every chooser across all alternatives.
Currently &#8220;single chooser&#8221; mode must be used with a <cite>choice_mode</cite>
of &#8216;aggregate&#8217; and &#8220;full product&#8221; mode must be used with a
<cite>choice_mode</cite> of &#8216;individual&#8217;.</p>
</div></blockquote>
<p><strong>choice_mode</strong> : str, optional</p>
<blockquote>
<div><p>Specify the method to use for making choices among alternatives.
Available string options are &#8216;individual&#8217; and &#8216;aggregate&#8217;.
In &#8220;individual&#8221; mode choices will be made separately for each chooser.
In &#8220;aggregate&#8221; mode choices are made for all choosers at once.
Aggregate mode implies that an alternative chosen by one agent
is unavailable to other agents and that the same probabilities
can be used for all choosers.
Currently &#8220;individual&#8221; mode must be used with a <cite>probability_mode</cite>
of &#8216;full_product&#8217; and &#8220;aggregate&#8221; mode must be used with a
<cite>probability_mode</cite> of &#8216;single_chooser&#8217;.</p>
</div></blockquote>
<p><strong>choosers_fit_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to choosers table before fitting the model.</p>
</div></blockquote>
<p><strong>choosers_predict_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the choosers table before calculating
new data points.</p>
</div></blockquote>
<p><strong>alts_fit_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the alternatives table before fitting the model.</p>
</div></blockquote>
<p><strong>alts_predict_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the alternatives table before calculating
new data points.</p>
</div></blockquote>
<p><strong>interaction_predict_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the merged choosers/alternatives table
before predicting agent choices.</p>
</div></blockquote>
<p><strong>estimation_sample_size</strong> : int, optional</p>
<blockquote>
<div><p>Whether to sample choosers during estimation
(needs to be applied after choosers_fit_filters).</p>
</div></blockquote>
<p><strong>prediction_sample_size</strong> : int, optional</p>
<blockquote>
<div><p>Whether (and how much) to sample alternatives during prediction.
Note that this can lead to multiple choosers picking the same
alternative.</p>
</div></blockquote>
<p><strong>choice_column</strong> : optional</p>
<blockquote>
<div><p>Name of the column in the <cite>alternatives</cite> table that choosers
should choose. e.g. the &#8216;building_id&#8217; column. If not provided
the alternatives index is used.</p>
</div></blockquote>
<p><strong>name</strong> : optional</p>
<blockquote class="last">
<div><p>Optional descriptive name for this model that may be used
in output.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.alts_columns_used">
<code class="descname">alts_columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.alts_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.alts_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the alternatives table that are used for filtering.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.apply_fit_filters">
<code class="descname">apply_fit_filters</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.apply_fit_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.apply_fit_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for fitting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>filtered_choosers, filtered_alts</strong> : pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.apply_predict_filters">
<code class="descname">apply_predict_filters</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.apply_predict_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.apply_predict_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for prediction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>filtered_choosers, filtered_alts</strong> : pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.assert_fitted">
<code class="descname">assert_fitted</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.assert_fitted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.assert_fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises <cite>RuntimeError</cite> if the model is not ready for prediction.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.choosers_columns_used">
<code class="descname">choosers_columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.choosers_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.choosers_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the choosers table that are used for filtering.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.columns_used">
<code class="descname">columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from any table used in the model. May come from either
the choosers or alternatives tables.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em>, <em>current_choice</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and save model parameters based on given data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</div></blockquote>
<p><strong>current_choice</strong> : pandas.Series or any</p>
<blockquote>
<div><p>A Series describing the <cite>alternatives</cite> currently chosen
by the <cite>choosers</cite>. Should have an index matching <cite>choosers</cite>
and values matching the index of <cite>alternatives</cite>.</p>
<p>If a non-Series is given it should be a column in <cite>choosers</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>log_likelihoods</strong> : dict</p>
<blockquote class="last">
<div><p>Dict of log-liklihood values describing the quality of the
model fit. Will have keys &#8216;null&#8217;, &#8216;convergence&#8217;, and &#8216;ratio&#8217;.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.fit_from_cfg">
<em class="property">classmethod </em><code class="descname">fit_from_cfg</code><span class="sig-paren">(</span><em>choosers</em>, <em>chosen_fname</em>, <em>alternatives</em>, <em>cfgname</em>, <em>outcfgname=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.fit_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.fit_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : DataFrame</p>
<blockquote>
<div><p>A dataframe in which rows represent choosers.</p>
</div></blockquote>
<p><strong>chosen_fname</strong> : string</p>
<blockquote>
<div><p>A string indicating the column in the choosers dataframe which
gives which alternatives the choosers have chosen.</p>
</div></blockquote>
<p><strong>alternatives</strong> : DataFrame</p>
<blockquote>
<div><p>A table of alternatives. It should include the choices
from the choosers table as well as other alternatives from
which to sample.  Values in choosers[chosen_fname] should index
into the alternatives dataframe.</p>
</div></blockquote>
<p><strong>cfgname</strong> : string</p>
<blockquote>
<div><p>The name of the yaml config file from which to read the discrete
choice model.</p>
</div></blockquote>
<p><strong>outcfgname</strong> : string, optional (default cfgname)</p>
<blockquote>
<div><p>The name of the output yaml config file where estimation results are written into.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lcm</strong> : MNLDiscreteChoiceModel which was used to fit</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.fitted">
<code class="descname">fitted</code><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>True if model is ready for prediction.</p>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.from_yaml">
<em class="property">classmethod </em><code class="descname">from_yaml</code><span class="sig-paren">(</span><em>yaml_str=None</em>, <em>str_or_buffer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.from_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a DiscreteChoiceModel instance from a saved YAML configuration.
Arguments are mutally exclusive.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>yaml_str</strong> : str, optional</p>
<blockquote>
<div><p>A YAML string from which to load model.</p>
</div></blockquote>
<p><strong>str_or_buffer</strong> : str or file like, optional</p>
<blockquote>
<div><p>File name or buffer from which to load YAML.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">MNLDiscreteChoiceModel</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.interaction_columns_used">
<code class="descname">interaction_columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.interaction_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.interaction_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the interaction dataset used for filtering and in
the model. These may come originally from either the choosers or
alternatives tables.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose from among alternatives for a group of agents.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing.</p>
</div></blockquote>
<p><strong>debug</strong> : bool</p>
<blockquote>
<div><p>If debug is set to true, will set the variable &#8220;sim_pdf&#8221; on
the object to store the probabilities for mapping of the
outcome.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>choices</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.predict_from_cfg">
<em class="property">classmethod </em><code class="descname">predict_from_cfg</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em>, <em>cfgname=None</em>, <em>cfg=None</em>, <em>alternative_ratio=2.0</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.predict_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.predict_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate choices for the specified choosers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : DataFrame</p>
<blockquote>
<div><p>A dataframe of agents doing the choosing.</p>
</div></blockquote>
<p><strong>alternatives</strong> : DataFrame</p>
<blockquote>
<div><p>A dataframe of locations which the choosers are locating in and
which have a supply.</p>
</div></blockquote>
<p><strong>cfgname</strong> : string</p>
<blockquote>
<div><p>The name of the yaml config file from which to read the discrete
choice model.</p>
</div></blockquote>
<p><strong>cfg: string</strong></p>
<blockquote>
<div><p>an ordered yaml string of the model discrete choice model configuration.
Used to read config from memory in lieu of loading cfgname from disk.</p>
</div></blockquote>
<p><strong>alternative_ratio</strong> : float, optional</p>
<blockquote>
<div><p>Above the ratio of alternatives to choosers (default of 2.0),
the alternatives will be sampled to meet this ratio
(for performance reasons).</p>
</div></blockquote>
<p><strong>debug</strong> : boolean, optional (default False)</p>
<blockquote>
<div><p>Whether to generate debug information on the model.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>choices</strong> : pandas.Series</p>
<blockquote>
<div><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</div></blockquote>
<p class="last"><strong>lcm</strong> : MNLDiscreteChoiceModel which was used to predict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.probabilities">
<code class="descname">probabilities</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em>, <em>filter_tables=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the probabilities for a set of choosers to choose
from among a set of alternatives.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing.</p>
</div></blockquote>
<p><strong>filter_tables</strong> : bool, optional</p>
<blockquote>
<div><p>If True, filter <cite>choosers</cite> and <cite>alternatives</cite> with prediction
filters before calculating probabilities.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>probabilities</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Probability of selection associated with each chooser
and alternative. Index will be a MultiIndex with alternative
IDs in the inner index and chooser IDs in the out index.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.report_fit">
<code class="descname">report_fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.report_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.report_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a report of the fit results.</p>
</dd></dl>

<dl class="attribute">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.str_model_expression">
<code class="descname">str_model_expression</code><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.str_model_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Model expression as a string suitable for use with patsy/statsmodels.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.summed_probabilities">
<code class="descname">summed_probabilities</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.summed_probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.summed_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate total probability associated with each alternative.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>probs</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Total probability associated with each alternative.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.to_dict">
<code class="descname">to_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.to_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dict respresentation of an MNLDiscreteChoiceModel
instance.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModel.to_yaml">
<code class="descname">to_yaml</code><span class="sig-paren">(</span><em>str_or_buffer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModel.to_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModel.to_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a model respresentation to YAML.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>str_or_buffer</strong> : str or file like, optional</p>
<blockquote>
<div><p>By default a YAML string is returned. If a string is
given here the YAML will be written to that file.
If an object with a <code class="docutils literal"><span class="pre">.write</span></code> method is given the
YAML will be written to that object.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>j</strong> : str</p>
<blockquote class="last">
<div><p>YAML is string if <cite>str_or_buffer</cite> is not given.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup">
<em class="property">class </em><code class="descclassname">urbansim.models.dcm.</code><code class="descname">MNLDiscreteChoiceModelGroup</code><span class="sig-paren">(</span><em>segmentation_col</em>, <em>remove_alts=False</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Manages a group of discrete choice models that refer to different
segments of choosers.</p>
<p>Model names must match the segment names after doing a pandas groupby.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>segmentation_col</strong> : str</p>
<blockquote>
<div><p>Name of a column in the table of choosers. Will be used to perform
a pandas groupby on the choosers table.</p>
</div></blockquote>
<p><strong>remove_alts</strong> : bool, optional</p>
<blockquote>
<div><p>Specify how to handle alternatives between prediction for different
models. If False, the alternatives table is not modified between
predictions. If True, alternatives that have been chosen
are removed from the alternatives table before doing another
round of prediction.</p>
</div></blockquote>
<p><strong>name</strong> : str, optional</p>
<blockquote class="last">
<div><p>A name that may be used in places to identify this group.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.add_model">
<code class="descname">add_model</code><span class="sig-paren">(</span><em>model</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.add_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.add_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an MNLDiscreteChoiceModel instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>model</strong> : MNLDiscreteChoiceModel</p>
<blockquote class="last">
<div><p>Should have a <code class="docutils literal"><span class="pre">.name</span></code> attribute matching one of the segments
in the choosers table.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.add_model_from_params">
<code class="descname">add_model_from_params</code><span class="sig-paren">(</span><em>name</em>, <em>model_expression</em>, <em>sample_size</em>, <em>probability_mode='full_product'</em>, <em>choice_mode='individual'</em>, <em>choosers_fit_filters=None</em>, <em>choosers_predict_filters=None</em>, <em>alts_fit_filters=None</em>, <em>alts_predict_filters=None</em>, <em>interaction_predict_filters=None</em>, <em>estimation_sample_size=None</em>, <em>prediction_sample_size=None</em>, <em>choice_column=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.add_model_from_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.add_model_from_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a model by passing parameters through to MNLDiscreteChoiceModel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong></p>
<blockquote>
<div><p>Must match a segment in the choosers table.</p>
</div></blockquote>
<p><strong>model_expression</strong> : str, iterable, or dict</p>
<blockquote>
<div><p>A patsy model expression. Should contain only a right-hand side.</p>
</div></blockquote>
<p><strong>sample_size</strong> : int</p>
<blockquote>
<div><p>Number of choices to sample for estimating the model.</p>
</div></blockquote>
<p><strong>probability_mode</strong> : str, optional</p>
<blockquote>
<div><p>Specify the method to use for calculating probabilities
during prediction.
Available string options are &#8216;single_chooser&#8217; and &#8216;full_product&#8217;.
In &#8220;single chooser&#8221; mode one agent is chosen for calculating
probabilities across all alternatives. In &#8220;full product&#8221; mode
probabilities are calculated for every chooser across all
alternatives.</p>
</div></blockquote>
<p><strong>choice_mode</strong> : str or callable, optional</p>
<blockquote>
<div><p>Specify the method to use for making choices among alternatives.
Available string options are &#8216;individual&#8217; and &#8216;aggregate&#8217;.
In &#8220;individual&#8221; mode choices will be made separately for each
chooser. In &#8220;aggregate&#8221; mode choices are made for all choosers at
once. Aggregate mode implies that an alternative chosen by one
agent is unavailable to other agents and that the same
probabilities can be used for all choosers.</p>
</div></blockquote>
<p><strong>choosers_fit_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to choosers table before fitting the model.</p>
</div></blockquote>
<p><strong>choosers_predict_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the choosers table before calculating
new data points.</p>
</div></blockquote>
<p><strong>alts_fit_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the alternatives table before fitting the model.</p>
</div></blockquote>
<p><strong>alts_predict_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the alternatives table before calculating
new data points.</p>
</div></blockquote>
<p><strong>interaction_predict_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the merged choosers/alternatives table
before predicting agent choices.</p>
</div></blockquote>
<p><strong>estimation_sample_size</strong> : int, optional</p>
<blockquote>
<div><p>Whether to sample choosers during estimation
(needs to be applied after choosers_fit_filters)</p>
</div></blockquote>
<p><strong>prediction_sample_size</strong> : int, optional</p>
<blockquote>
<div><p>Whether (and how much) to sample alternatives during prediction.
Note that this can lead to multiple choosers picking the same
alternative.</p>
</div></blockquote>
<p><strong>choice_column</strong> : optional</p>
<blockquote class="last">
<div><p>Name of the column in the <cite>alternatives</cite> table that choosers
should choose. e.g. the &#8216;building_id&#8217; column. If not provided
the alternatives index is used.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.alts_columns_used">
<code class="descname">alts_columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.alts_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.alts_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the alternatives table that are used for filtering.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.apply_fit_filters">
<code class="descname">apply_fit_filters</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.apply_fit_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.apply_fit_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for fitting.
This is done by filtering each submodel and concatenating
the results.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>filtered_choosers, filtered_alts</strong> : pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.apply_predict_filters">
<code class="descname">apply_predict_filters</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.apply_predict_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.apply_predict_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for prediction.
This is done by filtering each submodel and concatenating
the results.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>filtered_choosers, filtered_alts</strong> : pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.choosers_columns_used">
<code class="descname">choosers_columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.choosers_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.choosers_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the choosers table that are used for filtering.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.columns_used">
<code class="descname">columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from any table used in the model. May come from either
the choosers or alternatives tables.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em>, <em>current_choice</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and save models based on given data after segmenting
the <cite>choosers</cite> table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.
Must have a column with the same name as the .segmentation_col
attribute.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</div></blockquote>
<p><strong>current_choice</strong></p>
<blockquote>
<div><p>Name of column in <cite>choosers</cite> that indicates which alternative
they have currently chosen.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>log_likelihoods</strong> : dict of dict</p>
<blockquote class="last">
<div><p>Keys will be model names and values will be dictionaries of
log-liklihood values as returned by MNLDiscreteChoiceModel.fit.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.fitted">
<code class="descname">fitted</code><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether all models in the group have been fitted.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.interaction_columns_used">
<code class="descname">interaction_columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.interaction_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.interaction_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the interaction dataset used for filtering and in
the model. These may come originally from either the choosers or
alternatives tables.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose from among alternatives for a group of agents after
segmenting the <cite>choosers</cite> table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing.</p>
</div></blockquote>
<p><strong>debug</strong> : bool</p>
<blockquote>
<div><p>If debug is set to true, will set the variable &#8220;sim_pdf&#8221; on
the object to store the probabilities for mapping of the
outcome.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>choices</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.probabilities">
<code class="descname">probabilities</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns alternative probabilties for each chooser segment as
a dictionary keyed by segment name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>probabilties</strong> : dict of pandas.Series</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.MNLDiscreteChoiceModelGroup.summed_probabilities">
<code class="descname">summed_probabilities</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#MNLDiscreteChoiceModelGroup.summed_probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.MNLDiscreteChoiceModelGroup.summed_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sum of probabilities for alternatives across all
chooser segments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>probs</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Summed probabilities from each segment added together.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel">
<em class="property">class </em><code class="descclassname">urbansim.models.dcm.</code><code class="descname">SegmentedMNLDiscreteChoiceModel</code><span class="sig-paren">(</span><em>segmentation_col</em>, <em>sample_size</em>, <em>probability_mode='full_product'</em>, <em>choice_mode='individual'</em>, <em>choosers_fit_filters=None</em>, <em>choosers_predict_filters=None</em>, <em>alts_fit_filters=None</em>, <em>alts_predict_filters=None</em>, <em>interaction_predict_filters=None</em>, <em>estimation_sample_size=None</em>, <em>prediction_sample_size=None</em>, <em>choice_column=None</em>, <em>default_model_expr=None</em>, <em>remove_alts=False</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>An MNL LCM group that allows segments to have different model expressions
but otherwise share configurations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>segmentation_col</strong></p>
<blockquote>
<div><p>Name of column in the choosers table that will be used for groupby.</p>
</div></blockquote>
<p><strong>sample_size</strong> : int</p>
<blockquote>
<div><p>Number of choices to sample for estimating the model.</p>
</div></blockquote>
<p><strong>probability_mode</strong> : str, optional</p>
<blockquote>
<div><p>Specify the method to use for calculating probabilities
during prediction.
Available string options are &#8216;single_chooser&#8217; and &#8216;full_product&#8217;.
In &#8220;single chooser&#8221; mode one agent is chosen for calculating
probabilities across all alternatives. In &#8220;full product&#8221; mode
probabilities are calculated for every chooser across all alternatives.
Currently &#8220;single chooser&#8221; mode must be used with a <cite>choice_mode</cite>
of &#8216;aggregate&#8217; and &#8220;full product&#8221; mode must be used with a
<cite>choice_mode</cite> of &#8216;individual&#8217;.</p>
</div></blockquote>
<p><strong>choice_mode</strong> : str, optional</p>
<blockquote>
<div><p>Specify the method to use for making choices among alternatives.
Available string options are &#8216;individual&#8217; and &#8216;aggregate&#8217;.
In &#8220;individual&#8221; mode choices will be made separately for each chooser.
In &#8220;aggregate&#8221; mode choices are made for all choosers at once.
Aggregate mode implies that an alternative chosen by one agent
is unavailable to other agents and that the same probabilities
can be used for all choosers.
Currently &#8220;individual&#8221; mode must be used with a <cite>probability_mode</cite>
of &#8216;full_product&#8217; and &#8220;aggregate&#8221; mode must be used with a
<cite>probability_mode</cite> of &#8216;single_chooser&#8217;.</p>
</div></blockquote>
<p><strong>choosers_fit_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to choosers table before fitting the model.</p>
</div></blockquote>
<p><strong>choosers_predict_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the choosers table before calculating
new data points.</p>
</div></blockquote>
<p><strong>alts_fit_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the alternatives table before fitting the model.</p>
</div></blockquote>
<p><strong>alts_predict_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the alternatives table before calculating
new data points.</p>
</div></blockquote>
<p><strong>interaction_predict_filters</strong> : list of str, optional</p>
<blockquote>
<div><p>Filters applied to the merged choosers/alternatives table
before predicting agent choices.</p>
</div></blockquote>
<p><strong>estimation_sample_size</strong> : int, optional</p>
<blockquote>
<div><p>Whether to sample choosers during estimation
(needs to be applied after choosers_fit_filters)</p>
</div></blockquote>
<p><strong>prediction_sample_size</strong> : int, optional</p>
<blockquote>
<div><p>Whether (and how much) to sample alternatives during prediction.
Note that this can lead to multiple choosers picking the same
alternative.</p>
</div></blockquote>
<p><strong>choice_column</strong> : optional</p>
<blockquote>
<div><p>Name of the column in the <cite>alternatives</cite> table that choosers
should choose. e.g. the &#8216;building_id&#8217; column. If not provided
the alternatives index is used.</p>
</div></blockquote>
<p><strong>default_model_expr</strong> : str, iterable, or dict, optional</p>
<blockquote>
<div><p>A patsy model expression. Should contain only a right-hand side.</p>
</div></blockquote>
<p><strong>remove_alts</strong> : bool, optional</p>
<blockquote>
<div><p>Specify how to handle alternatives between prediction for different
models. If False, the alternatives table is not modified between
predictions. If True, alternatives that have been chosen
are removed from the alternatives table before doing another
round of prediction.</p>
</div></blockquote>
<p><strong>name</strong> : str, optional</p>
<blockquote class="last">
<div><p>An optional string used to identify the model in places.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.add_segment">
<code class="descname">add_segment</code><span class="sig-paren">(</span><em>name</em>, <em>model_expression=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.add_segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.add_segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new segment with its own model expression.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong></p>
<blockquote>
<div><p>Segment name. Must match a segment in the groupby of the data.</p>
</div></blockquote>
<p><strong>model_expression</strong> : str or dict, optional</p>
<blockquote class="last">
<div><p>A patsy model expression that can be used with statsmodels.
Should contain both the left- and right-hand sides.
If not given the default model will be used, which must not be
None.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.alts_columns_used">
<code class="descname">alts_columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.alts_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.alts_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the alternatives table that are used for filtering.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.apply_fit_filters">
<code class="descname">apply_fit_filters</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.apply_fit_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.apply_fit_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for fitting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>filtered_choosers, filtered_alts</strong> : pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.apply_predict_filters">
<code class="descname">apply_predict_filters</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.apply_predict_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.apply_predict_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <cite>choosers</cite> and <cite>alternatives</cite> for prediction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>filtered_choosers, filtered_alts</strong> : pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.choosers_columns_used">
<code class="descname">choosers_columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.choosers_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.choosers_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the choosers table that are used for filtering.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.columns_used">
<code class="descname">columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from any table used in the model. May come from either
the choosers or alternatives tables.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em>, <em>current_choice</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and save models based on given data after segmenting
the <cite>choosers</cite> table. Segments that have not already been explicitly
added will be automatically added with default model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.
Must have a column with the same name as the .segmentation_col
attribute.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing,
e.g. buildings.</p>
</div></blockquote>
<p><strong>current_choice</strong></p>
<blockquote>
<div><p>Name of column in <cite>choosers</cite> that indicates which alternative
they have currently chosen.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>log_likelihoods</strong> : dict of dict</p>
<blockquote class="last">
<div><p>Keys will be model names and values will be dictionaries of
log-liklihood values as returned by MNLDiscreteChoiceModel.fit.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fit_from_cfg">
<em class="property">classmethod </em><code class="descname">fit_from_cfg</code><span class="sig-paren">(</span><em>choosers</em>, <em>chosen_fname</em>, <em>alternatives</em>, <em>cfgname</em>, <em>outcfgname=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.fit_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fit_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : DataFrame</p>
<blockquote>
<div><p>A dataframe of rows of agents that have made choices.</p>
</div></blockquote>
<p><strong>chosen_fname</strong> : string</p>
<blockquote>
<div><p>A string indicating the column in the choosers dataframe which
gives which alternative the choosers have chosen.</p>
</div></blockquote>
<p><strong>alternatives</strong> : DataFrame</p>
<blockquote>
<div><p>A dataframe of alternatives. It should include the current choices
from the choosers dataframe as well as some other alternatives from
which to sample.  Values in choosers[chosen_fname] should index
into the alternatives dataframe.</p>
</div></blockquote>
<p><strong>cfgname</strong> : string</p>
<blockquote>
<div><p>The name of the yaml config file from which to read the discrete
choice model.</p>
</div></blockquote>
<p><strong>outcfgname</strong> : string, optional (default cfgname)</p>
<blockquote>
<div><p>The name of the output yaml config file where estimation results are written into.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lcm</strong> : SegmentedMNLDiscreteChoiceModel which was used to fit</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fitted">
<code class="descname">fitted</code><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.fitted" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether models for all segments have been fit.</p>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.from_yaml">
<em class="property">classmethod </em><code class="descname">from_yaml</code><span class="sig-paren">(</span><em>yaml_str=None</em>, <em>str_or_buffer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.from_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a SegmentedMNLDiscreteChoiceModel instance from a saved YAML
configuration. Arguments are mutally exclusive.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>yaml_str</strong> : str, optional</p>
<blockquote>
<div><p>A YAML string from which to load model.</p>
</div></blockquote>
<p><strong>str_or_buffer</strong> : str or file like, optional</p>
<blockquote>
<div><p>File name or buffer from which to load YAML.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">SegmentedMNLDiscreteChoiceModel</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.interaction_columns_used">
<code class="descname">interaction_columns_used</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.interaction_columns_used"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.interaction_columns_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Columns from the interaction dataset used for filtering and in
the model. These may come originally from either the choosers or
alternatives tables.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose from among alternatives for a group of agents after
segmenting the <cite>choosers</cite> table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing.</p>
</div></blockquote>
<p><strong>debug</strong> : bool</p>
<blockquote>
<div><p>If debug is set to true, will set the variable &#8220;sim_pdf&#8221; on
the object to store the probabilities for mapping of the
outcome.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>choices</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.predict_from_cfg">
<em class="property">classmethod </em><code class="descname">predict_from_cfg</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em>, <em>cfgname=None</em>, <em>cfg=None</em>, <em>alternative_ratio=2.0</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.predict_from_cfg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.predict_from_cfg" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate the discrete choices for the specified choosers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : DataFrame</p>
<blockquote>
<div><p>A dataframe of agents doing the choosing.</p>
</div></blockquote>
<p><strong>alternatives</strong> : DataFrame</p>
<blockquote>
<div><p>A dataframe of alternatives which the choosers are locating in and
which have a supply.</p>
</div></blockquote>
<p><strong>cfgname</strong> : string</p>
<blockquote>
<div><p>The name of the yaml config file from which to read the discrete
choice model.</p>
</div></blockquote>
<p><strong>cfg: string</strong></p>
<blockquote>
<div><p>an ordered yaml string of the model discrete choice model configuration.
Used to read config from memory in lieu of loading cfgname from disk.</p>
</div></blockquote>
<p><strong>alternative_ratio</strong> : float</p>
<blockquote>
<div><p>Above the ratio of alternatives to choosers (default of 2.0),
the alternatives will be sampled to meet this ratio
(for performance reasons).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>choices</strong> : pandas.Series</p>
<blockquote>
<div><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</div></blockquote>
<p class="last"><strong>lcm</strong> : SegmentedMNLDiscreteChoiceModel which was used to predict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.probabilities">
<code class="descname">probabilities</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns alternative probabilties for each chooser segment as
a dictionary keyed by segment name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>probabilties</strong> : dict of pandas.Series</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.summed_probabilities">
<code class="descname">summed_probabilities</code><span class="sig-paren">(</span><em>choosers</em>, <em>alternatives</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.summed_probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.summed_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sum of probabilities for alternatives across all
chooser segments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>choosers</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the agents making choices, e.g. households.
Must have a column matching the .segmentation_col attribute.</p>
</div></blockquote>
<p><strong>alternatives</strong> : pandas.DataFrame</p>
<blockquote>
<div><p>Table describing the things from which agents are choosing.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>probs</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Summed probabilities from each segment added together.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.to_dict">
<code class="descname">to_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.to_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict representation of this instance suitable for
conversion to YAML.</p>
</dd></dl>

<dl class="method">
<dt id="urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.to_yaml">
<code class="descname">to_yaml</code><span class="sig-paren">(</span><em>str_or_buffer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#SegmentedMNLDiscreteChoiceModel.to_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.SegmentedMNLDiscreteChoiceModel.to_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a model respresentation to YAML.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>str_or_buffer</strong> : str or file like, optional</p>
<blockquote>
<div><p>By default a YAML string is returned. If a string is
given here the YAML will be written to that file.
If an object with a <code class="docutils literal"><span class="pre">.write</span></code> method is given the
YAML will be written to that object.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>j</strong> : str</p>
<blockquote class="last">
<div><p>YAML is string if <cite>str_or_buffer</cite> is not given.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="urbansim.models.dcm.unit_choice">
<code class="descclassname">urbansim.models.dcm.</code><code class="descname">unit_choice</code><span class="sig-paren">(</span><em>chooser_ids</em>, <em>alternative_ids</em>, <em>probabilities</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/urbansim/models/dcm.html#unit_choice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#urbansim.models.dcm.unit_choice" title="Permalink to this definition">¶</a></dt>
<dd><p>Have a set of choosers choose from among alternatives according
to a probability distribution. Choice is binary: each
alternative can only be chosen once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chooser_ids</strong> : 1d array_like</p>
<blockquote>
<div><p>Array of IDs of the agents that are making choices.</p>
</div></blockquote>
<p><strong>alternative_ids</strong> : 1d array_like</p>
<blockquote>
<div><p>Array of IDs of alternatives among which agents are making choices.</p>
</div></blockquote>
<p><strong>probabilities</strong> : 1d array_like</p>
<blockquote>
<div><p>The probability that an agent will choose an alternative.
Must be the same shape as <cite>alternative_ids</cite>. Unavailable
alternatives should have a probability of 0.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>choices</strong> : pandas.Series</p>
<blockquote class="last">
<div><p>Mapping of chooser ID to alternative ID. Some choosers
will map to a nan value when there are not enough alternatives
for all the choosers.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="supplydemand.html" class="btn btn-neutral float-right" title="Supply and Demand Accounting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Core Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, UrbanSim Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>